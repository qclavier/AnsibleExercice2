---
- hosts: all
  become: true
  tasks:
  # module pour installer docker
  - name: install docker
    apt:
      name:
        - docker
      update_cache: yes
  # module pour créer les dossier où stocker les fichier sources
  - name: création des dossiers /home/sources
    file:
        path: /home/sources
        mode: '0755'
        state: directory
  # module pour copier les fichiers sources
  - name: copie des fichiers sources
    copy: 
      src: fichiers_sources/
      dest: /home/sources
  # module pour monter l'image de result
  - name: Construction de l'image result
    community.docker.docker_image:
        build:
            path: /fichiers_sources/result/
        name: img_result
  # module pour monter l'image de vote
  - name: Construction de l'image vote
    community.docker.docker_image:
        build:
            dockerfile: present
            path: /fichiers_sources/vote/
        name: img_vote
  # module pour monter l'image de worker
  - name: Construction de l'image worker
    community.docker.docker_image:
        build:
            dockerfile: present
            path: /fichiers_sources/worker/
            name: worker
        name: img_worker
  # module pour supprimer les fichiers sources
  - name: Suppression fichiers sources
